{
    "collab_server" : "",
    "contents" : "---\ntitle: \"drpr-vignette\"\nauthor: \"Neil Diamond\"\ndate: \"`r Sys.Date()`\"\noutput: rmarkdown::html_vignette\nvignette: >\n  %\\VignetteIndexEntry{drpr-vignette}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\n\n#Introduction\n\nAn R package, drpr, has been built to undertake the DRP calculations in R.\n\n```{r, echo=FALSE}\nlibrary(printr)\n```\n\nTo install the package you use the command \"install.packages('drpr_0.992.zip', repos=NULL)\". \n\n  \nYou then need to load the package:\n```{r, echo=TRUE, eval==TRUE}\nlibrary(\"drpr\")\n\nJan15m <- Jan15[order(Jan15$Maturity),][-1,]\n\n```\n\nNote that Jan15 is an example data file. In the following, I have used Jan15 with the bond with the lowest maturity removed. The user can load his or her own data using say \"Dec15 <- read.csv('Dec15.csv')\" where the .csv file must have (at least) three numeric columns labelled \"Maturity\", \"Yield\",\nand \"Amount.issued\".\n\n#No Adjustment for Credit Raings\n  \n##Gaussian Smoothing\n\nThe underlying Gaussian smoothing is done by the gswt1() function. For convenience, the gkest1() calls the gswt1() function for target terms to maturity of 3, 5, 7, and 10 years. The documentation for the two functions and an Example is given below:\n\n```{r, echo=TRUE}\n?gswt1\n?gkest1\nfit0 <- gswt1(data=Jan15m)\nprint(fit0)\nsummary(fit0)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit0)\n```\n\n```{r}\n```\n\n\n\n\n##Fitting the Nelson-Siegel model\n\nThe Nelson-Siegel model is fitted using the fitnelsonsiegel() function. Be default, the starting value for the decay factor is 0.7173, which is the value maximising the loading of the curvature factor for a maturity of 2.5 years.\n\n```{r, echo=TRUE}\nlibrary(drpr)\nlibrary(minpack.lm)\n?fitnelsonsiegel\nfitnelsonsiegel(Jan15m)\n```\n\n\n\n```{r, echo=TRUE}\nfit1 <- fitnelsonsiegel(Jan15m)\nprint(fit1)\nsummary(fit1)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit1)\n```\n\n```{r}\n```\n\n\n##Fitting the Nelson-Siegel-Svensson model\n\nThe Nelson-Siegel-Svensson model is fitted using the fitnelsonsiegelsvensson() function. Be default, the starting value for the two decay factors maximise the loading of the curvature factor for a maturity of 2.5 years and a maturity of 5 years. However, note well, the inverse decay factors are used.\n\n\n```{r, echo=TRUE}\n?fitnelsonsiegelsvensson\nfitnelsonsiegelsvensson(Jan15, lambda1start=1/lambdastart(2.5),\n                               lambda2start=1/lambdastart(5))\n```\n\n\n```{r, echo=TRUE}\nfit2 <- fitnelsonsiegelsvensson(Jan15m, lambda1start=1/lambdastart(2.5),\n                               lambda2start=1/lambdastart(5))\nprint(fit2)\nsummary(fit2)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit2)\n\n```\n\n###Fixing the lambda parameters\nIf the lambda parameters are fixed then they can be input with the option fixed=T.\n\n```{r}\nfit2a <- fitnelsonsiegelsvensson(Jan15, lambda1start=0.17,\n                               lambda2start=3.4038, fixed=T)\nprint(fit2a)\nsummary(fit2a)\n```\n\n\n##Obtaining the DRP\n\nThe average of the annualised ten year yield estimates using the three estimation techniques are combined with the average spot rate to give an annualised DRP. At this stage it is required to input the average spot rate on a semi-annual basis.\n\n```{r, echo=TRUE}\n?drp\ndrp(fit0, fit1, fit2, avspotratesa=2.9546)\n```\n\n\n##Comparisons\n\nThe package can be used to make graphical comparisons between the three techniques:\n\n```{r, echo=TRUE, fig.height=6,fig.width=8}\ndrpplot(fit0, fit1, fit2)\n```\n\n```{r}\n```\n\n\n#Adjusting for Credit Raings\n\nA major shortcoming of the calculations above is that they do not adjust for credit ratings. Additional functions are provided that do this adjustment.\n\n##Gaussian Smoothing\n\nThe function gswt1adjust() adjusts for credit ratings using the technique of backfitting. This is an iterative technique: First the credit ratings are ignored and the usual Gaussian Kernel is applied. Then a linear model is fitted to the residuals and the fitted model is used to adjust for the credit ratings. The process is continued until convergence. In most case only a small number of iterations are required.\n\n```{r, echo=TRUE}\n?gswt1adjust\n?gkest1adjust\nfit3 <- gswt1adjust(data=Jan15m)\n```\n\n\n\n\n```{r, echo=TRUE, fig.height=6,fig.width=8}\nprint(fit3)\nsummary(fit3)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit3)\n```\n\n```{r}\n```\n\n\n##Fitting the Nelson-Siegel model\n\nThe model allows the level parameter to depend on the credit rating but the other parameters are constrained to be the same. \n\n```{r, echo=TRUE}\nlibrary(drpr)\nlibrary(minpack.lm)\n?fitnelsonsiegeladjust\nfit4 <- fitnelsonsiegeladjust(Jan15m)\n```\n\n\n```{r, echo=TRUE}\nprint(fit4)\nsummary(fit4)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit4)\n```\n\n```{r}\n```\n\n\n##Fitting the Nelson-Siegel-Svensson model\n\nThe model allows the level parameter to depend on the credit rating but the other parameters are constrained to be the same.\n\n```{r, echo=TRUE}\n?fitnelsonsiegelsvenssonadjust\nfit5 <- fitnelsonsiegelsvenssonadjust(Jan15m, lambda1start=1/lambdastart(2.5),\n                               lambda2start=1/lambdastart(5))\n```\n\n\n```{r, echo=TRUE}\nprint(fit5)\nsummary(fit5)\n```\n\n```{r, echo=T, fig.height=6,fig.width=8}\nplot(fit5)\n```\n\n```{r}\n```\n\n\n\n##Obtaining the DRP\n\nThe three results are combined.\n\n```{r, echo=TRUE}\n?drpadjust\ndrpadjust(fit3,fit4,fit5, avspotratesa=2.9546)\n```\n\n#The code\n\n```{r, echo=TRUE}\ngswt1\ngkest1\ngetS3method(\"print\", \"GaussianSmooth\")\ngetS3method(\"summary\", \"GaussianSmooth\")\ngetS3method(\"plot\", \"GaussianSmooth\")\nlambdastart\nfitnelsonsiegel\ngetS3method(\"print\", \"NelsonSiegel\")\ngetS3method(\"summary\", \"NelsonSiegel\")\ngetS3method(\"plot\", \"NelsonSiegel\")\nfitnelsonsiegelsvensson\ngetS3method(\"print\", \"NelsonSiegelSvensson\")\ngetS3method(\"summary\", \"NelsonSiegelSvensson\")\ngetS3method(\"plot\", \"NelsonSiegelSvensson\")\ndrp\ndrpplot\ngswt1adjust\ngkest1adjust\ngetS3method(\"print\", \"GaussianSmoothAdjust\")\ngetS3method(\"summary\", \"GaussianSmoothAdjust\")\ngetS3method(\"plot\", \"GaussianSmoothAdjust\")\nfitnelsonsiegeladjust\ngetS3method(\"print\", \"NelsonSiegelAdjust\")\ngetS3method(\"summary\", \"NelsonSiegelAdjust\")\ngetS3method(\"plot\", \"NelsonSiegelAdjust\")\nfitnelsonsiegelsvenssonadjust\ngetS3method(\"print\", \"NelsonSiegelSvenssonAdjust\")\ngetS3method(\"summary\", \"NelsonSiegelSvenssonAdjust\")\ngetS3method(\"plot\", \"NelsonSiegelSvenssonAdjust\")\ndrpadjust\n```\n\n#Example Data\n\n```{r, echo=TRUE, size=fit1}\nJan15[,c(4,7,10,11)]\n```\n\n",
    "created" : 1454927915955.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3518222799",
    "id" : "187FB8C0",
    "lastKnownWriteTime" : 1479849815,
    "last_content_update" : 1479849815549,
    "path" : "~/Documents/DRP/drpr/vignettes/drpr-vignette.Rmd",
    "project_path" : "vignettes/drpr-vignette.Rmd",
    "properties" : {
    },
    "relative_order" : 38,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}