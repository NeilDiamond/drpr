{
    "collab_server" : "",
    "contents" : "\n\\documentclass[11pt,a4paper]{article}\n\\usepackage{graphicx, color}\n\\usepackage[table]{xcolor}\n\\usepackage{pdfpages}\n\\usepackage{amsmath}\n\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{latexsym,amsfonts,pifont,mathpazo,multicol,epsfig,graphics}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{graphicx,hyperref}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{color,rotating}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{paralist,ifthen}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{ctable,here,bbding,longtable}\n\\usepackage{draftwatermark}\n\\SetWatermarkText{Draft Confidential}                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{graphicx}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{fancyhdr}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{eso-pic}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{wrapfig}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{url}\n                                                                                                                                                                                                                                                                                                                                                                                   \\usepackage{chngpage}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{eso-pic}\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage{pdfpages}\n                                                                                                                                                                                                                                                                                                                                                                                            \\usepackage[margin=0.75in]{geometry}\n                                                                                                                                                                                                                                                                                                                                                                                            \\def\\imagetop#1{\\vtop{\\null\\hbox{#1}}}\n                                                                                                                                                                                                                                                                                                                                                                                            \\fancyhf{} % clear all header and footers\n                                                                                                                                                                                                                                                                                                                                                                                            \\renewcommand{\\headrulewidth}{0pt} % remove the header rule\n                                                                                                                                                                                                                                                                                                                                                                                            \\rfoot{\\thepage}\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\pagestyle{fancy}\n\n\\begin{document}\n\n\\begin{titlepage}\n\n\\begin{flushleft}\n\\includegraphics[width=0.5\\textwidth]{esquantlogo.pdf}\\\\[2cm]\n\\end{flushleft}\n\n\n\n\\begin{center}\n\n\n\n{ \\huge \\bfseries DRP package}\\\\[1cm]\n\n\n\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\textsc{\\Large \\bfseries Neil Diamond, B.Sc.(Hons), Ph.D., A.Stat.}\\\\[0.5cm]\n\n\\textsc{\\Large \\bfseries ESQUANT Statistical Consulting}\\\\[1cm]\n\n\n\n\n\n\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\vfill\n\n        % Bottom of the page\n{\\large \\bfseries \\today}\n\n        \\end{center}\n        \\end{titlepage}\n\n        \\AddToShipoutPictureBG{%\n        \\AtPageLowerLeft{\\\\\\includegraphics[width=0.3\\textwidth]{esquantlogo}}}\n\n\n        \\setcounter{page}{2}\n\n        \\clearpage\n\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\tableofcontents\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\clearpage\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\listoftables\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\clearpage\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\listoffigures\n\n                                                                                                                                                                                                                                                                                                                                                                                            \\clearpage\n\n\\section{Introduction}\nThe ERA (WA) has set out a series of steps using Excel to calculate the Debt Risk Premium (DRP), see Attachment 3 of ~\\cite(ERA, 2015). In calculating the DRP, the ERA (WA) used three techniques:\n\\begin{itemize}\n\\item Guassian Kernel\n\\item The Nelson-Siegel Methodology\n\\item Nelson-Siegel-Svensson Model\n\\end{itemize}\n\nFor all three techniques, the ERA (WA) give detailed instructions as to how to calculate the cost of debt and how to combine the results to give a final figure. In the next section, the ERA results will be\n\n\\section{Reproduction of ERA Excel calculations}\n\nThe ERA Excel calculations have been reproduced in a series of workbooks. The workbooks have named according to the Table number in the ERA report. The calculations have been done for the 20 day period begining 20 January 2015 and ending 30 January 2015. I've assumed that the data selection steps have been followed, that is the input data for Table~145 of ERA(2015) are  available.\n\n\\subsection{Table 145}\nGiven a series of remaining terms to maturity, amount issued in Australian dollars, and yields, this workbook gives the Gaussian Smoothed yield according to the RBA Methodology (Arsov et al. 2013). The workbook is intended to be used four times with Target Tenors in cell K1 of 3, 5, 7, and 10 years. The output, to be inserted into the workbook corresponding to Table~146, is the Target Tenor yield, given in cell K9, and the Effective Term to Maturity, given in the last cell of column J.\n\nThe worksbook is named \\texttt{Table145.xlsx}. The results for 3, 5, 7, and 10 years are in \\texttt{Table145Tenor3.xlsx}, \\texttt{table145Tenor5.xlsx}, \\texttt{Table145Tenor145Tenor7.xlsx}, and \\textttt{Table145Tenor10.xlsx}, respectively.\n\nThe results are given in Table~\\ref{table145results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\nlibrary(\"xlsx\")\nTenor3 <- read.xlsx(file=\"./inst/extdata/Table145Tenor3.xlsx\", sheetIndex=1, header=F)\nTenor5 <- read.xlsx(file=\"./inst/extdata/Table145Tenor5.xlsx\", sheetIndex=1, header=F)\nTenor7 <- read.xlsx(file=\"./inst/extdata/Table145Tenor7.xlsx\", sheetIndex=1, header=F)\nTenor10 <- read.xlsx(file=\"./inst/extdata/Table145Tenor10.xlsx\", sheetIndex=1, header=F)\nresultmat <- matrix(c(3,5,7,10,\n                      round(Tenor3[63,10],4),round(Tenor5[63,10],4),round(Tenor7[63,10],4),round(Tenor10[63,10],4),\n                      round(Tenor3[9,11],4),round(Tenor5[9,11],4),round(Tenor7[9,11],4),round(Tenor10[9,11],4)),4,3)\ncolnames(resultmat) <- c(\"Tenor\",\"Effective Term\",\"Target Tenor Yield\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nrequire(xtable)\nprint(xtable(resultmat,caption=\"Output from Table145\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,0,4,4), label=\"table145results\"),include.rownames=FALSE)\n@\n\n\\subsection{Table 146}\nTaking the results from Table~145, in this table the results are converted to Annualized yields, and then the extrapolation of the results is carried out, in order to remove the bias of the Gaussian smoothing method. The workbook is named \\texttt{Table146.xlsx} and the annualized 10 year yield is given in cell F2, and the extrapolated 10 year annualized yield is given in cell F4.\n\nThe results are given in Table~\\ref{table146results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\n\ntable146 <- read.xlsx(file=\"./inst/extdata/Table146.xlsx\", sheetIndex=1, header=F)\n\ntable146res <- matrix(c(round(table146[2,6],4),round(table146[4,6],4)),2,1)\nrow.names(table146res) <- c(\"Extrapolated 10 Year yield (Semi-Annual Basis)\",\n                            \"Extrapolated 10 Year yield (Annualized)\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nrequire(xtable)\nprint(xtable(table146res,caption=\"Output from Table146\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table146results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\n\\subsection{Table147}\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\n\ntable147 <- read.xlsx(file=\"./inst/extdata/Table147.xlsx\", sheetIndex=1, header=F)\n\n\n@\nThis table gives the starting value for the decay factor $\\lambda$ and is given in \\texttt{Table147.xlsx}. The input workbook is \\texttt{Table147Input.xlsx} and the output workbook is \\texttt{Table147Output.xlsx}. The starting value should be \\Sexpr{round(table147[3,1],4)}.\n\n\\subsection{Table148}\n\nThe starting value for the decay factor, 0.7173, is input into cell A1 of \\texttt{Table148.xlsx}. Columns B and C are the remaining terms to maturity and yield values, respectively. Columns D and E are the first and second loadings, corresponding to the Nelson-Siegel model with $\\lambda$ given by 0.7173. Multiple linear regression, with an intercept, is applied with columns D and E as the independent variables and Column C as the dependent variable. Cells G17, G18, and G19 give the starting values for beta1, beta2, and beta3, respectively.\n\nThe input workbook is \\texttt{Table148.xlsx} and the output workbook is \\texttt{table148Output.xlsx}. The starting values are given in Table~\\ref{table148results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable148Output <- read.xlsx(file=\"./inst/extdata/Table148Output.xlsx\", sheetIndex=1, header=F)\nbetastart <- round(as.numeric(as.character(table148Output[17:19,7])),4)\nlambdastart <- round(as.numeric(as.character(table148Output[1,1])),4)\nstartvalues <- matrix(c(betastart,lambdastart),4,1)\nrow.names(startvalues) <- c(\"beta1\", \"beta2\", \"beta3\",\"lambda\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(startvalues,caption=\"Start Values (Output from Table148)\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table148results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\subsection{Table149}\n\nWith the starting values, this workbook calculates the residual sum of squares. Solver is then used to minimise the residual sum of squares by changing the parameter values. The input workbook is given in \\texttt{Table149Input.xlsx} and the output workbook is given in \\texttt{Table149Output.xlsx}. Note that the parameter estimates are given in cells E1 to E4, given in Table~\\ref{table149results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable149Output <- read.xlsx(file=\"./inst/extdata/Table149Output.xlsx\", sheetIndex=1, header=F)\nparams <- matrix(round(as.numeric(as.character(table149Output[1:4,5])),4),4,1)\nrow.names(params) <- c(\"beta1\", \"beta2\", \"beta3\",\"lambda\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(params,caption=\"Nelson-Siegel Parameter Estimates (Output from Table149)\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table149results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\\subsection{Table150and151}\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable150and151 <- read.xlsx(file=\"./inst/extdata/Table150and151.xlsx\", sheetIndex=1, header=F)\nyieldest <- round(matrix(table150and151[2:3,4],2,1),4)\nrow.names(yieldest) <- c(\"Ten Year Yield (semi annual basis)\",\"Ten Year Yield (Annual Basis)\")\n@\n\n\n\nTaking the parameter estimates from Table~149, in this table the semi-annualized yields at 3, 5, 7, and 10 years are calculated and then converted to annualized yields. The workbook is given in \\texttt{Table150and151.xlsx} and the 10 year annualized yield is given in cell D3.\n\nThe results are given in Table~\\ref{table150and151results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(yieldest,caption=\"Output from Table150and151\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table150and151results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\subsection{Table152}\n\n\nThe starting value for the first decay factor and second decay factors are input into cells A1 and A2 of \\texttt{Table152.xlsx}. The ERA have suggested last years values. However, Diebold and Rudebusch suggest the values that maximise the loadings at 2.5 and 5 years term to maturity. Note that the ERA are using ``inverse\" decay factors-accordingly the start values should be 1.3941 and 3.0670 respectively.\n\nColumns B and C are the remaining terms to maturity and yield values, respectively. Columns D, E, and F are the first, second, and third loadings, corresponding to the Nelson-Siegel-Svensson model with $\\lambda_1$ given by 1.3941 and $\\lambda_2$ given by 3.0670. Multiple linear regression, with an intercept, is applied with columns D, E, F as the independent variables and Column C as the dependent variable. Cells H17, H18, H19, and H20 give the starting values for beta1, beta2, beta3, and beta4, respectively.\n\nThe input workbook is \\texttt{Table152.xlsx} and the output workbook is \\texttt{table152Output.xlsx}. The starting values are given in Table~\\ref{table152results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable152Output <- read.xlsx(file=\"./inst/extdata/Table152Output.xlsx\", sheetIndex=1, header=F)\nbetastart <- round(as.numeric(as.character(table152Output[17:20,8])),4)\nlambdastart <- round(as.numeric(as.character(table152Output[1:2,1])),4)\nstartvalues.nss <- matrix(c(betastart,lambdastart),6,1)\nrow.names(startvalues.nss) <- c(\"beta1\", \"beta2\", \"beta3\",\"beta4\",\"lambda1\",\"lambda2\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(startvalues.nss,caption=\"Start Values (Output from Table152)\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table152results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\subsection{Table153}\n\nWith the starting values, this workbook calculates the residual sum of squares. Solver is then used to minimise the residual sum of squares by changing the parameter values. The input workbook is given in \\texttt{Table153Input.xlsx} and the output workbook is given in \\texttt{Table153Output.xlsx}. Note that the parameter estimates are given in cells E1 to E4, given in Table~\\ref{table153results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable153Output <- read.xlsx(file=\"./inst/extdata/Table153Output.xlsx\", sheetIndex=1, header=F)\nparams.nss <- matrix(round(as.numeric(as.character(table153Output[1:6,5])),4),6,1)\nrow.names(params.nss) <- c(\"beta1\", \"beta2\", \"beta3\",\"beta4\",\"lambda1\",\"lambda2\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(params.nss,caption=\"Nelson-Siegel-Svensson Parameter Estimates (Output from Table153)\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table153results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\subsection{Table154and155}\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable154and155 <- read.xlsx(file=\"./inst/extdata/Table154and155.xlsx\", sheetIndex=1, header=F)\nyieldest.nss <- round(matrix(table154and155[2:3,4],2,1),4)\nrow.names(yieldest.nss) <- c(\"Ten Year Yield (semi annual basis)\",\"Ten Year Yield (Annual Basis)\")\n@\n\n\n\nTaking the parameter estimates from Table~153, in this table the semi-annualized yields at 3, 5, 7, and 10 years are calculated and then converted to annualized yields. The workbook is given in \\texttt{Table154and155.xlsx} and the 10 year annualized yield is given in cell D3.\n\nThe results are given in Table~\\ref{table154and155results}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(yieldest.nss,caption=\"Output from Table154and155\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table154and155results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\subsection{Table156}\n\nFinally,  the three estimates of the 10 year annualized yield are averaged to give an overall estimate, and then the average of the 10 year swap rate is annualized and subtracted from the overall estimate, to give the final 10 year DRP estimate in cell B24 of the workbook given in \\texttt{Table156.xlsx}.\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='hide'>>=\ntable156 <- read.xlsx(file=\"./inst/extdata/Table156.xlsx\", sheetIndex=1, header=F)\ntable156results <- round(matrix(table156[21:24,2],4,1),4)\nrow.names(table156results) <- c(\"Average Swap rate (Semi-Annual basis)\",\"Annualized Swap Average (Annual Basis)\",\n                             \"10 year final cost of debt estimate\", \"10 year DRP\")\n@\n\n<<echo=FALSE,message=FALSE,warning=FALSE,results='asis'>>=\nprint(xtable(table156results,caption=\"Output from Table156\",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               digits=c(0,4), label=\"table156results\"),include.rownames=TRUE, include.colnames=FALSE)\n@\n\n\\section{Critique of the ERA (WA) Methodology}\n\nIn this section some strengths and weaknesses of the ERA metholdology are given.\n\n\\begin{enumerate}\n\\item It was relatively easy to follow the steps given by the ERA. However, it would probably be better to have a VBA routine which only requires the user to supply the data and the various calculations are done with the press of a button.\n\\item The workbooks do not contain column headers and this may cause errors. For example, in Table~145 if the Yield and Maturity were interchanged the results would be incorrect. By adding column errors, this risk would be eliminated. Similarly, it would be helpful to add labels next to important cells in the workbooks.\n\\item A major weakness of all three procedures is that no adjustment is made for the credit ratings of the bonds. It is possible to make these adjustments and this should improve the reliability of the results.\n\\item The Nelson-Siegel-Svensson Parameteric Form used by the ERA is (dropping subscripts $t$)\n\\[y(\\tau) &=  &\\beta_0+\\beta_1\\left(\\frac{1-e^{-\\tau/\\lambda_1 }}{\\tau/\\lambda_1 }\\right)+\\beta_2\\left(\\frac{1-e^{-\\tau/\\lambda_1}}{\\tau/\\lambda_1}-e^{-\\tau/\\lambda_1}\\right)+\\beta_3\\left(\\frac{1-e^{-\\tau/\\lambda_2}}{\\tau/\\lambda_2}-e^{-\\tau/\\lambda_2}\\right). \\]\nThis is the original form in which it was published by Svensson. However, just as the Nelson-Siegel model is usually written as\n\\[y(\\tau) =  &\\beta_0+\\beta_1\\left(\\frac{1-e^{-\\lambda \\tau }}{\\lambda \\tau }\\right)+\\beta_2\\left(\\frac{1-e^{-\\lambda \\tau }}{\\lambda \\tau }-e^{-\\lambda \\tau }\\right) \\]\nrather than as it was introduced by Nelson and Siegel (1987), the The Nelson-Siegel-Svensson equation is now usually written as (see, for example, Diebold and Rudebusch, 2013, p. 106.)\n\\[ y(\\tau) &=  &\\beta_0+\\beta_1\\left(\\frac{1-e^{-\\lambda_1\\tau}}{\\lambda_1\\tau}\\right)+\\beta_2\\left(\\frac{1-e^{-\\lambda_1\\tau}}{\\lambda_1\\tau}-e^{-\\lambda_1\\tau}\\right)+\\beta_3\\left(\\frac{1-e^{-\\lambda_2\\tau}}{\\lambda_2\\tau}-e^{-\\lambda_2\\tau}\\right) \\]\n\n\\end{enumerate}\n\n\\clearpage\n\n\\section{R Package drpr}\n\nAn R package has been built to undertake the above calculatins in R.\n\n\\subsection{Gaussian Smoothing}\n\nThe underlying Gaussian smoothing is done by the \\texttt{gswt1()} function. The user should only need to call the \\texttt{gkest1()} function. An example is given below.\n\n\n\n\n<<echo=TRUE,message=FALSE,warning=FALSE,results='markup'>>=\ninstall.packages(\"drpr_0.1.tar.gz\", repos=NULL, type=\"source\")\nlibrary(\"drpr\")\n?gkest1\ngkest1(sigma=1.5, filename=Jan15)\n@\n\n\\subsection{Fitting Nelson-Siegel model}\n\n\n\n<<echo=TRUE,message=FALSE,warning=FALSE,results='markup'>>=\n?fitnelsonsiegel\nfitnelsonsiegel(data=Jan15)\n@\n\n\n\n\n\\subsection{Fitting Nelson-Siegel-Svensson model}\n\n<<echo=TRUE,message=FALSE,warning=FALSE,results='markup'>>=\n?fitnelsonsiegelsvennson\nfitnelsonsiegelsvensson(data=Jan15)\n@\n\n\n\n\\section{References}\n\n\\noindent Diebold, F.X. and Rudebusch, G.D. (2013). \\emph{Yield Curve Modeling and Forecasting: The Dynamic Nelson-Siegel Approach.} Princeton University Press, New Jersey.\\\\\n\n\n\\noindent ERA (2015). Mid-West and South West Gas Distribution Systems Access Arrangements 2015-2019: Consultation on Proposed Amendements to the Final Decision.\\\\\n\n\n\n\\noindent Hastie, T., Tibshirani, R., and Friedman, J. (2009). \\emph{The Elements of Statistical Learning: Data Mining, Inference, and Prediction,} 2nd Edition. Springer: New York.\\\\\n\n\n\n\n\n\\noindent Nelson C.R. and Siegel, A.F. (1987). `Parsimonious Modeling of Yield Curves', \\emph{The Journal of Business,} {\\bf 60}(4), pp 473--489.\\\\\n\n\\noindent Svennson, L.E.O. (1995). `Estimatomg Forward Interest Rates with the Extended Nelson-Siegel Method,' \\emph{Sveriges Riksbank Quarteley Review,} {\\bf 3}, pp 13--26.\\\\\n\n\\end{document}\n",
    "created" : 1453349561526.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "621176211",
    "id" : "6BCEE6A4",
    "lastKnownWriteTime" : 1453349579,
    "last_content_update" : 0,
    "path" : "~/Documents/DRP 2/DRP.Rnw",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 29,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "sweave"
}